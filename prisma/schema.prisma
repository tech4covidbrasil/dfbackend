// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

model Usuario {
    id                String    @id @default(uuid())
    nome              String    @unique
    email             String    @unique
    senha             String
    senhaResetToken   String?
    senhaResetExpires DateTime?
    tipoUsuario       String

    termos      Boolean  @default(false)
    lgpd        Boolean  @default(false)
    isValidated Boolean? @default(false)

    updated_at DateTime @updatedAt
    created_at DateTime @default(now())

    Foto        Foto?
    Endereco    Endereco?
    Documento   Documento?
    UsuarioRole UsuarioRole?

    Doacao            Doacao[]
    Campanha          Campanha[]
    HistoricoUsuario  HistoricoUsuario[]
    CampanhaFavorita  CampanhaFavorita[]
    UsuarioRedeSocial UsuarioRedeSocial[]

    @@map("tbUsuario")
}

model Documento {
    id             String @id @default(uuid())
    dataNascimento String
    documentoValor String

    usuario   Usuario @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
    usuarioId String  @unique

    tipoDocumento   TipoDocumento @relation(fields: [tipoDocumentoId], references: [id])
    tipoDocumentoId Int           @unique

    updated_at DateTime @updatedAt
    created_at DateTime @default(now())

    @@map("tbDocumento")
}

model TipoDocumento {
    id      Int    @id @default(autoincrement())
    docNome String @unique

    updated_at DateTime    @updatedAt
    created_at DateTime    @default(now())
    Documento  Documento[]

    @@map("tbTipoDocumento")
}

model Foto {
    id        String @id @default(uuid())
    foto_nome String
    foto_path String

    usuario   Usuario @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
    usuarioId String  @unique

    updated_at DateTime @updatedAt
    created_at DateTime @default(now())

    @@map("tbFoto")
}

model Endereco {
    id String @id @default(uuid())

    ddd      String
    telefone String @unique

    cep         String
    endereco    String
    numero      Int
    complemento String?
    bairro      String

    //	Definir se a cidade/estado será selecionado manualmente ou preenchido automaticamente pela api
    cidade String
    estado String

    usuario   Usuario @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
    usuarioId String  @unique

    updated_at DateTime @updatedAt
    created_at DateTime @default(now())

    @@map("tbEndereco")
}

model LandingPageLeads {
    id            String   @id @default(uuid())
    nome          String   @unique
    email         String   @unique
    telefone      String   @unique
    cidade        String
    estado        String
    tipoLead      String
    termosAceitos Boolean
    updated_at    DateTime @updatedAt
    created_at    DateTime @default(now())

    @@map("tbLandingPage")
}

model Doacao {
    id String @id @default(uuid())

    usuario   Usuario @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
    usuarioId String

    campanha   Campanha @relation(fields: [campanhaId], references: [id])
    campanhaId String

    produto   Produto @relation(fields: [produtoId], references: [id])
    produtoId Int

    quantidadeDoada Int

    isValidated Boolean @default(false)

    updated_at            DateTime                @updatedAt
    created_at            DateTime                @default(now())
    ProdutoCampanhaDoacao ProdutoCampanhaDoacao[]

    @@map("tbDoacao")
}

model Campanha {
    id   String @id @default(uuid())
    nome String

    //	Vai ser utilizada nossa tabela de Cidades/Estados?
    cidadeCampanha String
    estadoCampanha String

    tipoArrecadacao     String
    descricao           String
    dataCriacaoCampanha DateTime @default(now())
    dataTerminoCampanha DateTime
    isValidated         Boolean  @default(false)
    isActive            Boolean  @default(false)

    usuario   Usuario @relation(fields: [usuarioId], references: [id])
    usuarioId String

    updated_at DateTime @updatedAt
    created_at DateTime @default(now())

    Doacao           Doacao[]
    ProdutoCampanha  ProdutoCampanhaDoacao[]
    CampanhaFavorita CampanhaFavorita[]

    @@map("tbCampanha")
}

model UnidadeMedida {
    //	Kg, Litro, Unidade
    id         Int    @id @default(autoincrement())
    nome       String @unique
    abreviacao String

    updated_at DateTime @updatedAt
    created_at DateTime @default(now())

    ProdutoMedida ProdutoMedida[]

    @@map("tbUnidadeMedida")
}

model Produto {
    id   Int    @id @default(autoincrement())
    nome String @unique

    updated_at DateTime @updatedAt
    created_at DateTime @default(now())

    Doacao          Doacao[]
    ProdutoCampanha ProdutoCampanhaDoacao[]
    ProdutoMedida   ProdutoMedida[]

    @@map("tbProduto")
}

model ProdutoCampanhaDoacao {
    id String @id @default(uuid())

    produto   Produto @relation(fields: [produtoId], references: [id])
    produtoId Int

    campanha   Campanha @relation(fields: [campanhaId], references: [id])
    campanhaId String

    doacao   Doacao @relation(fields: [doacaoId], references: [id])
    doacaoId String

    quantidadeDoada Int

    updated_at DateTime @updatedAt
    created_at DateTime @default(now())

    @@map("tbProdutoCampanhaDoacao")
}

model HistoricoUsuario {
    id String @id @default(uuid())

    usuario   Usuario @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
    usuarioId String

    descricao  String
    created_at DateTime @default(now())

    @@map("tbHistoricoUsuario")
}

model ProdutoMedida {
    id String @id @default(uuid())

    produto   Produto @relation(fields: [produtoId], references: [id])
    produtoId Int

    unidadeMedida   UnidadeMedida @relation(fields: [unidadeMedidaId], references: [id])
    unidadeMedidaId Int

    created_at DateTime @default(now())

    @@map("tbProdutoMedida")
}

model Roles {
    id   String @id @default(uuid())
    nome Role?

    created_at  DateTime     @default(now())
    UsuarioRole UsuarioRole?

    @@map("tbRoles")
}

enum Role {
    USER
    ADMIN
}

model UsuarioRole {
    id String @id @default(uuid())

    usuario   Usuario? @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
    usuarioId String   @unique

    roles   Roles  @relation(fields: [rolesId], references: [id], onDelete: Cascade)
    rolesId String @unique

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    @@map("tbUsuarioRoles")
}

model Estados {
    id         Int    @id @default(autoincrement())
    nome       String @unique
    abreviacao String @unique

    created_at DateTime  @default(now())
    updated_at DateTime  @updatedAt
    Cidades    Cidades[]

    @@map("tbEstado")
}

model Cidades {
    id   Int    @id @default(autoincrement())
    nome String @unique

    estados   Estados @relation(fields: [estadosId], references: [id])
    estadosId Int     @unique

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    @@map("tbCidade")
}

// model OrgaoEmissor {
//     id   String @id @default(uuid())
//     nome String

//     created_at DateTime @default(now())
//     updated_at DateTime @updatedAt

//     @@map("tbOrgaoEmissor")
// }

model CampanhaFavorita {
    id String @id @default(uuid())

    usuarioId  String
    usuario    Usuario  @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
    campanhaId String
    campanha   Campanha @relation(fields: [campanhaId], references: [id])

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    @@map("tbCampanhaFavorita")
}

// model TipoContatoTelefone {
//     Usuário pode querer informar se o contato é (Fixo, Whatsapp, Celular)
//     id   String @id @default(uuid())
//     nome String

//     created_at DateTime @default(now())
//     updated_at DateTime @updatedAt

//     @@map("tbTipoContatoTelefone")
// }

// model UsuarioContato {
//     id        String @id @default(uuid())
//     usuarioId String
//     usuario    Usuario  @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

//     contato String

//     tipoContatoId String
//     tipoContato TipoContato @relation(fields: [tipoContatoId], references: [id])

//     created_at DateTime @default(now())
//     updated_at DateTime @updatedAt

//     @@map("tbUsuarioContato")
// }

model RedeSocial {
    id   Int    @id @default(autoincrement())
    nome String

    created_at        DateTime            @default(now())
    updated_at        DateTime            @updatedAt
    UsuarioRedeSocial UsuarioRedeSocial[]

    @@map("tbRedeSocial")
}

model UsuarioRedeSocial {
    id Int @id @default(autoincrement())

    usuarioId String
    usuario   Usuario @relation(fields: [usuarioId], references: [id])

    redesocial   RedeSocial @relation(fields: [redeSocialId], references: [id])
    redeSocialId Int

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    @@map("tbUsuarioRedeSocial")
}
